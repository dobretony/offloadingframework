\chapter{Introduction}
\label{chapter:intro}

%\textbf{This is just a demo file. It should not be used as a sample for a thesis.}\\
%\todo{Remove this line (this is a TODO)}

%\section{Project Description}
%\label{sec:proj}

%\subsection{Project Scope}
%\label{sub-sec:proj-scope}

%This thesis presents the \textbf{\project}.

%This is an example of a footnote \footnote{\url{www.google.com}}. You can see here a reference to \labelindexref{Section}{sub-sec:proj-objectives}.

%Here we have defined the CS abbreviation.\abbrev{CS}{Computer Science} and the UPB abbreviation.\abbrev{UPB}{University Politehnica of Bucharest}

%The main scope of this project is to qualify xLuna for use in critical systems.


%Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean aliquam lectus vel orci malesuada accumsan. Sed lacinia egestas tortor, eget tristiqu dolor congue sit amet. Curabitur ut nisl a nisi consequat mollis sit amet quis nisl. Vestibulum hendrerit velit at odio sodales pretium. Nam quis tortor sed ante varius sodales. Etiam lacus arcu, placerat sed laoreet a, facilisis sed nunc. Nam gravida fringilla ligula, eu congue lorem feugiat eu.

%Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean aliquam lectus vel orci malesuada accumsan. Sed lacinia egestas tortor, eget tristiqu dolor congue sit amet. Curabitur ut nisl a nisi consequat mollis sit amet quis nisl. Vestibulum hendrerit velit at odio sodales pretium. Nam quis tortor sed ante varius sodales. Etiam lacus arcu, placerat sed laoreet a, facilisis sed nunc. Nam gravida fringilla ligula, eu congue lorem feugiat eu.




%\subsection{Project Objectives}
%\label{sub-sec:proj-objectives}

%We have now included \labelindexref{Figure}{img:report-framework}.

%\fig[scale=0.5]{src/img/reporting-framework.pdf}{img:report-framework}{Reporting Framework}


%Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean aliquam lectus vel orci malesuada accumsan. Sed lacinia egestas tortor, eget tristiqu dolor congue sit amet. Curabitur ut nisl a nisi consequat mollis sit amet quis nisl. Vestibulum hendrerit velit at odio sodales pretium. Nam quis tortor sed ante varius sodales. Etiam lacus arcu, placerat sed laoreet a, facilisis sed nunc. Nam gravida fringilla ligula, eu congue lorem feugiat eu.

%We can also have citations like \cite{iso-odf}.

%\subsection{Related Work}

%Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean aliquam lectus vel orci malesuada accumsan. Sed lacinia egestas tortor, eget tristiqu dolor congue sit amet. Curabitur ut nisl a nisi consequat mollis sit amet quis nisl. Vestibulum hendrerit velit at odio sodales pretium. Nam quis tortor sed ante varius sodales. Etiam lacus arcu, placerat sed laoreet a, facilisis sed nunc. Nam gravida fringilla ligula, eu congue lorem feugiat eu.


%Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean aliquam lectus vel orci malesuada accumsan. Sed lacinia egestas tortor, eget tristiqu dolor congue sit amet. Curabitur ut nisl a nisi consequat mollis sit amet quis nisl. Vestibulum hendrerit velit at odio sodales pretium. Nam quis tortor sed ante varius sodales. Etiam lacus arcu, placerat sed laoreet a, facilisis sed nunc. Nam gravida fringilla ligula, eu congue lorem feugiat eu.


%Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean aliquam lectus vel orci malesuada accumsan. Sed lacinia egestas tortor, eget tristiqu dolor congue sit amet. Curabitur ut nisl a nisi consequat mollis sit amet quis nisl. Vestibulum hendrerit velit at odio sodales pretium. Nam quis tortor sed ante varius sodales. Etiam lacus arcu, placerat sed laoreet a, facilisis sed nunc. Nam gravida fringilla ligula, eu congue lorem feugiat eu.

%We are now discussing the \textbf{Ultimate answer to all knowledge}.
%This line is particularly important it also adds an index entry for \textit{Ultimate answer to all knowledge}.\index{Ultimate answer to all knowledge}

%\subsection{Demo listings}

%We can also include listings like the following:

% Inline Listing example
%\lstset{language=make,caption=Application Makefile,label=lst:app-make}
%\begin{lstlisting}
%CSRCS = app.c
%SRC_DIR =..
%include $(SRC_DIR)/config/application.cfg
%\end{lstlisting}

%Listings can also be referenced. References don't have to include chapter/table/figure numbers... so we can have hyperlinks \labelref{like this}{lst:makefile-test}.

%\subsection{Tables}

%We can also have tables... like \labelindexref{Table}{table:reports}.

%\begin{center}
%\begin{table}[htb]
%  \caption{Generated reports - associated Makefile targets and scripts}
%  \begin{tabular}{l*{6}{c}r}
%    Generated report & Makefile target & Script \\
%    \hline
%    Full Test Specification & full_spec & generate_all_spec.py  \\
%    Test Report & test_report & generate_report.py  \\
%    Requirements Coverage & requirements_coverage &
%    generate_requirements_coverage.py   \\
%    API Coverage & api_coverage & generate_api_coverage.py  \\
%  \end{tabular}
% \label{table:reports}
%\end{table}
%\end{center}


In past years, mobile devices have encountered a widespread use among technical and regular consumers world wide. This increase in popularity is based on the advent of the Internet and social media, together with easy to use, user-friendly interfaces and applications for hand held devices worldwide. A mobile device is not defined anymore as a strict communication device, but as a hand held computer that acts as an access point to content and information sharing.


Although this growth spark of recent years has lead to over the top technological advances, mobile devices have their limits which is mostly reflected in their size and battery life. The key for a successful device is to provide a user-friendly interface with a rich set of features, ranging from on-the-go connectivity to playing media. The main issue that arises in such a rich environment is the constraints on battery life and the fact that producers need to maintain a balance between usability and efficiency. Most smart phones today run on a typical battery of 1500 mAh \cite{ferreira2011understanding}, mainly because this is a limitation in size. Unlike smart phone technology that has developed drastically in the past few years, battery technology has been evolving for the past century and no such large breakthrough has been discovered in the last 15 years\cite{batteryLife}.


Developers for and of the smart phone platforms have since realized that they need to bypass the hardware constraints and create either power efficient chipsets and components or create efficient software that provides the selected features that are in demand. A method that can achieve a more efficient energy consumption on smart phone devices would be a mixed approach of power efficient hardware and the ability to communicate with other devices and software, called code offloading.


Computational offloading\index{offloading} is a technique used to share the processing power of several devices between each other in order to achieve better performance. Code offloading is a technique that has gained a lot of interest recently due to the possibility of using the \textit{System as a Service} architecture of cloud computing in order to offload resource intensive operations to cloud-based surrogates\cite{shiraz2013review}, especially in the case of low-power devices such as smartphones. 

This technique usually occurs at the code level, where a mobile application may be partitioned such that some of the more process-intensive tasks or algorithms would be run on separate machines. The partitioning can be done either by the developer, statically, or it can be determined at runtime, dynamically, by a simple linear algorithm that measures the cost of data transfer and the potential offloading gain that can be achieved for certain tasks. 

Because the cost might outweigh the benefit gained, offloading should be considered an optional process preferred in mobile operations that require high amounts of processing time and low amounts of data transferred between devices\cite{kumar2010cloud}. Previous works have also identified that computational offloading is required mainly by applications that implement graphical rendering, image and video processing techniques\cite{cuervo2010maui} \cite{chun2011clonecloud}.

Data binding or task delegation is a model that can be considered a form of offloading where developers create an application based on the loose coupled model. These types of application usually do not function without connectivity to other devices and may follow different schema \cite{klein2010access}, one of the most common methodology being Web API calls and thus enriching mobile applications with the power of Web technologies. 

The main notion of this form of offloading is that instead of doing certain tasks on a mobile device, you create an asynchronous call to another machine that will do the work and then provide a result. It is different from code offloading because the working assumption is that the mobile device cannot do the offloaded task in either a timely fashion or does not have the required technology or security access. 

A good example of data binding would be the path generation on an online map service, that could take a long time on a mobile embedded device versus a machine in the cloud that has access to caching algorithms and highly performant subroutines.

Following the notion of computational offloading with task delegation and the need for extended battery life, this paper proposes a system through which the process of code offloading and task delegation can be done efficiently over a low-energy imprint communication channel: Bluetooth Low Energy. \abbrev{BLE}{Bluetooth Low Energy}

Bluetooth (IEEE 802.15.1) is a technology based on a wireless radio system designed for short-range and low-cost devices in order to replace cables for computer peripherals, such as mice, keyboards, printers, etc. Since its conception, this standard has seen a wide variety of use and has evolved from its main purpose of interconnecting peripherals to creating small, wireless, personal area networks (WPAN) that permit advanced data transfer such as: file sharing, transmitting TCP/IP packets, data streaming over simulated Serial Ports and other uses.

Together with Bluetooth 4.0 specification a new design was proposed for low-energy devices, which represents a trade-off between energy consumption, latency and throughput. This new specification has been dubbed Bluetooth Low Energy \index{Bluetooth Low Energy} and since 2010 it has been implemented in most hand held devices along side Bluetooth, in a setup called dual-mode.

\section{Project Description}
\label{projectdescription}

One of the important factors when discussing computational offloading is the communication channel between devices. Most work in this field has been in done with the objective of using the powerful computational model of Cloud Computing\cite{kumar2010cloud} in order to establish an offloading system for mobile devices that transfers data and code through Internet connectivity, either through Wi-fi or 3GR wireless technologies. Usually this type of system implies that offloading is possible only when the right connectivity makes possible a certain gain of computational power, which is not always the case.

In order to mitigate the drawbacks of the aforementioned model, this paper proposes a new framework that uses the advantages of Bluetooth Low Energy in order to lower the cost of transferring the data between devices, thus maximizing the gain that a system can achieve when offloading.

As such, we present the BLEOffloadingFramework\index{BLEOffloadingFramework} (Bluetooth Low Energy Offloading Framework)\abbrev{BLEOffloadingFramework}{Bluetooth Low Energy Offloading Framework}, a framework designed for developers of mobile applications that uses low energy communication channels in order to transfer data and code between hand held devices, such as smartphones or tablets, with the specific objective of saving battery life of the desired embedded system.

One of the most energy consuming part in mobile embedded systems is the main Processing Unit. A correlation exists between the battery life of smartphones and the amount of time the CPU is doing work \cite{ferreira2011understanding}, especially in modern day devices, where processors have a high potential for computational power, but are not especially power efficient. Smartphone operating systems such as Android have additional protections against unnecessary CPU usage such as the Power Wake Lock, in which it creates a link between the screen of the device and the processor and forces the system to go into a sleep mode when the screen is turned off, thus preserving battery \cite{datta2012android}.

As such, one of the motivation behind offloading and the project presented in this paper would be creating an efficient and easy way to offload computational tasks in order to preserve battery life, with the key objective of extending user experience.

For this purpose, the BLEOffloadingFramework uses the low-energy specification of Bluetooth in order to transfer data between devices. This technology has been proved to be more efficient in transferring small chunks of data between devices \cite{mackensen2012performance} and helping the connection setup of the standard BR/EDR Bluetooth.

The framework follows a typical offloading system architecture, but instead of relying on Internet connectivity of the device it uses a wireless personal area network established through Bluetooth Low Energy. In a general offloading scenario when the right conditions are met the compute part of an algorithm can be transferred to the cloud, sending back a result of said computation that can be presented to the user or used in other parts of the application.



%\fig[scale=0.6]{src/img/GeneralOffloading.png}{img:general-offloading}{A general view on offloading}


The BLEOffloadingFramework takes this concept and applies it to a much smaller range network. The framework consists of an Offloading Server, that can be any Bluetooth enabled device, such as a Personal Computer, a laptop or even an embedded device, such as a Raspberry PI \footnote{Raspberry PI - a small ARM-based System on a Chip embedded device that can run a lightweight Linux distribution, used mainly for education and small embedded projects}. This server always runs a low-energy advertising technique (described in Section \ref{ble}) in which it promotes its existence to other devices.

If a device picks up on such a server and wants to perform offloading it will create and send a request to the server with the desired method that it wants to offload. The server then decides if it can process that request or not. It will send back to the device a Accept/Reject type of answer, in which Accept states that it can begin the offloading and Reject means that it is too busy at the moment.

Once the request is accepted, the server will compute the selected method and offer a response back to the application. 

Experimental results demonstrate that this typical scenario presents an increase in battery life, because the mobile device does relatively low processing on itself.

Because of its lightweight infrastructure and use of low-energy technology, the BLEOffloadingFramework presents a series of advantages over other offloading scenarios. In this paper, the method and implementation of this framework will be presented, together with the context and motivation behind this type of offloading and also the experimental setup used to demonstrate the principles of the framework.


\section{Project Objectives}
\label{objectives}

This thesis proposes a new system for computational offloading and task delegation by providing a seamless method for code and data transferring through Bluetooth Low Energy. The objectives of this project are as follow:

\begin{itemize}

\item{To present a new method for computational offloading with the goal of helping developers create energy efficient applications on mobile platforms.}

\item{To use the low-energy technology of Bluetooth in order to demonstrate the principle of code offloading and task delegation for mobile devices.}

\item{To provide developers of mobile applications with an easy method for implementing offloading over Bluetooth, through the use of an Application Programmable Interface (API).\abbrev{API}{Application Programmable Interface}}

\item{To make use of at least two offloading methods and provide a comparison between them.}

\item{To determine a testing method for use in comparing offloading solutions based on the framework.}

\item{To be scalable in terms of implementation and methodology.}

\item{To be generic in terms of methodology and architecture and thus not be limited to a certain platform or device.}

\item{To be transparent to both developers and users of this framework and to always ask for permission when offloading is possible so that there is no possibility of privacy obstruction.}

\item{To be secure, thus protecting user data and privacy.}

\end{itemize}

\section{Thesis structure}

In order to present the advantages of an offloading framework over the Bluetooth Low Energy communication channel, this paper first presents the background and related work that has caused the need for such a framework in Section \ref{chapter:stateoftheart}.

The main considerations when constructing such an offloading framework, and also the components that have to be considered when designing the system are presented in Section \ref{chapter:architecture}. In this section the design for the offloading client and the offload server is presented and also the two main offloading solutions are proposed.

The implementation of the offloading framework, both regarding the Android client and the offload Linux server, is regarded in Section \ref{chapter:implementation}.

In order to test the functionality of the system and to demonstrate that there is a possible gain from using offloading over Bluetooth Low Energy, in Section \ref{chapter:results} a test setup for the BLEOffloadFramework is presented, together with experimental results and a small guideline for the offloading solutions proposed earlier.

The conclusions of this thesis are drawn in Section \ref{chapter:conclusion}, where we can see the advantages that offloading brings us, with a note on future implementation marks.

